from brownie import Angel, accounts, MockLiveToken, Unrelated
from web3 import Web3

zero_address = "0x0000000000000000000000000000000000000000"


def register_account():
    acct = accounts.load("test-1")
    acct_two = accounts.load("test-2")

    angel = Angel[-1]

    username = "franfran"
    image_uri = "https://bafybeib3faghcn66ax5o5enqk3vfzp23senitu5vlbjh4ceus5fhmyskpe.ipfs.w3s.link/adventure%20time%204.jpg"

    tx_register_one = angel.registerAngelAccount(username, image_uri, {"from": acct})
    tx_register_one.wait(1)

    username = "genevarock"
    image_uri = "https://bafybeib3faghcn66ax5o5enqk3vfzp23senitu5vlbjh4ceus5fhmyskpe.ipfs.w3s.link/adventure%20time%204.jpg"

    tx_register = angel.registerAngelAccount(username, image_uri, {"from": acct_two})
    tx_register.wait(1)


def send_crypto():
    acct = accounts.load("test-1")
    acct_two = accounts.load("test-2")

    angel = Angel[-1]

    recipient = acct_two.address
    asset = zero_address
    amount = Web3.toWei(0.0000123, "ether")
    narration = "seasons greetings"
    claim_code = Web3.keccak(text="claimcode0030").hex()
    end_time = 30

    print("initiating second tx...")
    tx = angel.sendCrypto(
        recipient,
        asset,
        amount,
        narration,
        claim_code,
        end_time,
        {"from": acct, "value": amount},
    )
    tx.wait(1)

    print("Initiated!")


def send_nft():
    acct = accounts.load("test-1")
    acct_two = accounts.load("test-2")

    angel = Angel[-1]

    recipient = acct.address
    asset = Unrelated[-1].address
    token_id = 1
    narration = "happy birthday. I love you!"
    claim_code = Web3.keccak(text="claimcode0050").hex()
    end_time = 1800

    print("initiating second tx...")

    approve_tx = Unrelated[-1].approve(angel.address, token_id, {"from": acct_two})
    approve_tx.wait(1)

    tx = angel.sendNFT(
        recipient,
        asset,
        token_id,
        narration,
        claim_code,
        end_time,
        {
            "from": acct_two,
        },
    )
    tx.wait(1)

    print("Initiated!")


def claim_nft():
    # acct = accounts.load("test-1")
    acct_two = accounts.load("test-2")

    angel = Angel[-1]

    # tx details
    tx_ref = "0x2449cb8e48e8ceabee35286e7afad3f6fa62b633d7027826503d05976059062d"
    claim_code = "claimcode0050"

    print("initiating second tx...")
    tx = angel.claimFunds(
        tx_ref,
        claim_code,
        {"from": acct_two},
    )
    tx.wait(1)

    print("Initiated!")


def claim_crypto():
    acct = accounts.load("test-1")
    # acct_two = accounts.load("test-2")

    angel = Angel[-1]

    # tx details
    tx_ref = "0x8e24557ac44cc7dae2257ab2e7ab05714f28110460df0a841f10173615d48674"
    claim_code = "claimcode0030"

    print("initiating second tx...")
    tx = angel.claimFunds(
        tx_ref,
        claim_code,
        {"from": acct},
    )
    tx.wait(1)

    print("Initiated!")


def reclaim_crypto():
    acct = accounts.load("test-1")
    # acct_two = accounts.load("test-2")

    angel = Angel[-1]

    # tx details
    tx_ref = "0xf942a7f072f6dac372a8c8f3caf6c261b78ebe7627c0f5b1cf5ab5f06956c748"

    print("initiating second tx...")
    tx = angel.reclaimFunds(
        tx_ref,
        {"from": acct},
    )
    tx.wait(1)

    print("Initiated!")


def get_contract_balance():
    print(Angel[-1].balance())


def get_username():
    acct_two = accounts.load("test-2")
    print(Angel[-1].getUsername(acct_two.address))


def print_code_hash():
    print(Web3.keccak(text="hello").hex())


def deploy_or_set_token_uri():
    account = accounts.load("test-1")
    unrelated_nfts = Unrelated.deploy(
        "Unrelated",
        "URTD",
        "https://arweave.net/i2UasvWWr_eFHYmOXU2yp3JYVn4WHIS9UxJqHit697w/",
        {"from": account},
    )


def mint():
    account = accounts.load("test-1")
    unrelated_nfts = Unrelated[-1]
    tx_mint = unrelated_nfts.mint(7, {"from": account})
    tx_mint.wait(1)


def add_to_beneficiaries():
    acct = accounts.load("test-1")
    acct_two = accounts.load("test-2")

    angel = Angel[-1]
    beneficiary = acct.address

    tx = angel.addToBeneficiaries(beneficiary, {"from": acct_two})


def check_upkeep():
    angel = Angel[-1]

    valid, data = angel.checkUpkeep(b"")

    print(data)
    print("Upkeep Needed ", valid)


def perform_upkeep():
    angel = Angel[-1]

    acct = accounts.load("test-1")

    perform_data = "0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000f00000000000000000000000000000000000000000000000000000000000001e000000000000000000000000000000000000000000000000000000000000003a00000000000000000000000000000000000000000000000000000000000000560000000000000000000000000000000000000000000000000000000000000072000000000000000000000000000000000000000000000000000000000000008e00000000000000000000000000000000000000000000000000000000000000aa00000000000000000000000000000000000000000000000000000000000000c600000000000000000000000000000000000000000000000000000000000000e200000000000000000000000000000000000000000000000000000000000000fe000000000000000000000000000000000000000000000000000000000000011a00000000000000000000000000000000000000000000000000000000000001360000000000000000000000000000000000000000000000000000000000000152000000000000000000000000000000000000000000000000000000000000016e000000000000000000000000000000000000000000000000000000000000018a00000000000000000000000000000000000000000000000000000000000001a6000000000000000000000000079f85f6c4c926277ef97370d6f89ab1d78f6a4f800000000000000000000000052047de4458afaaff7c6b954c63033a21efcd2e60000000000000000000000009f192326c0c17b9f4e5f9a428cc958b887397f08000000000000000000000000000000000000000000000001158e460913d00000000000000000000000000000000000000000000000000000000000000000018000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000064576326f33d305bef413d7a9c49674d3630ae5a7be5028122ce123451ab4b43afbe222a00000000000000000000000000000000000000000000000000000000645767d674db5cd622e21d056633c44b5d76eb3b3abb65e38e703dc1630cac4d2744dbda00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000c66726f6d206d7920776966650000000000000000000000000000000000000000000000000000000000000000c0089cb5f8f286eaf6574666397834722e044d9b00000000000000000000000052047de4458afaaff7c6b954c63033a21efcd2e6000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000071afd498d00000000000000000000000000000000000000000000000000000000000000000180000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000645797e0f33d305bef413d7a9c49674d3630ae5a7be5028122ce123451ab4b43afbe222a0000000000000000000000000000000000000000000000000000000064579ee80bac38e77a738d4311ff134dfc06a5a43021449a8d9dc39a520fbc0b8ce95746000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000050000000000000000000000000000000000000000000000000000000000000011686176652061206c6f76656c7920646179000000000000000000000000000000000000000000000000000000eb846c5d1b5edb406e6d64129d3ea9418f0f140b00000000000000000000000052047de4458afaaff7c6b954c63033a21efcd2e60000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000775f05a074000000000000000000000000000000000000000000000000000000000000000018000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000064579c3cf33d305bef413d7a9c49674d3630ae5a7be5028122ce123451ab4b43afbe222a000000000000000000000000000000000000000000000000000000006457aa4c7792bf30ebe7da8d9d54727d5ec405da077c81a5afb3c978f5bb8aebb6c0259b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000010796f752061726520746865206265737400000000000000000000000000000000000000000000000000000000eb846c5d1b5edb406e6d64129d3ea9418f0f140b00000000000000000000000052047de4458afaaff7c6b954c63033a21efcd2e6000000000000000000000000e3088919a826125af0daf96cf74dca3583550bb6000000000000000000000000000000000000000000000001158e460913d00000000000000000000000000000000000000000000000000000000000000000018000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000064579e4061d541ff4ae730e1a596f5ba9cece2405814e814deba77ba70aea5c7a41da7d80000000000000000000000000000000000000000000000000000000064579f0574225a02f50f836940a32784cf83e10fcc53e5186e78e3541414d3b9dbb374ff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000070000000000000000000000000000000000000000000000000000000000000010776861747320676f696e67206f6e3f3f000000000000000000000000000000000000000000000000000000005f7fbe4bf8987fa77ec6c22fd3f3d558b3b68d4e00000000000000000000000079f85f6c4c926277ef97370d6f89ab1d78f6a4f80000000000000000000000008547708b3ed15ea5942b528f8a253b03fef9c3150000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000018000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000064579f5261d541ff4ae730e1a596f5ba9cece2405814e814deba77ba70aea5c7a41da7d8000000000000000000000000000000000000000000000000000000006457ad62a4847c3810461e5c6b7ab145fcb40e2d764fb49fc851f7809b3afcd755625f2b00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000b6163636573732070617373000000000000000000000000000000000000000000000000000000000000000000edd21444b31a9ba39f9c42940c6971f64689150c00000000000000000000000052047de4458afaaff7c6b954c63033a21efcd2e60000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000b677a5dbaa00000000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000006457a2d007dd65219237abf6f4528ca84506b455ce69beb4c67eaff9959e6b97ffeadccf000000000000000000000000000000000000000000000000000000006457a7808223a9b6544d165d184d64dc1d5528892583cf98bfdb5720389a95f1299fd78000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009000000000000000000000000000000000000000000000000000000000000001469747320796f7572207370656369616c2064617900000000000000000000000000000000000000000000000052047de4458afaaff7c6b954c63033a21efcd2e6000000000000000000000000edd21444b31a9ba39f9c42940c6971f64689150c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000121e6c485ac00000000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000006457a51c04e5d2edaa92546f170d10cfac1eb73197f126709b18b9ebcf45e0133ccad819000000000000000000000000000000000000000000000000000000006457b32cf27014f9cce9f2e25d0ce9999a474ab54fd73ee8782356419928f2ead5c7782d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000147468616e6b7320666f7220796f75722068656c70000000000000000000000000000000000000000000000000edd21444b31a9ba39f9c42940c6971f64689150c00000000000000000000000079f85f6c4c926277ef97370d6f89ab1d78f6a4f8000000000000000000000000e3088919a826125af0daf96cf74dca3583550bb60000000000000000000000000000000000000000000000008ac7230489e8000000000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000006457a92e78e6fca4ead9ffe836f8487721587901ae93db158bd0fdb002e8360785ab5294000000000000000000000000000000000000000000000000000000006457a96a60b190c14d1f167abd54b6aee3128c955d348c9236b6b50a2e37338291f887160000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000b00000000000000000000000000000000000000000000000000000000000000187468616e6b7320706f702e20492061707072656369617465000000000000000000000000000000000000000079f85f6c4c926277ef97370d6f89ab1d78f6a4f800000000000000000000000052047de4458afaaff7c6b954c63033a21efcd2e6000000000000000000000000c9a6e60b894e41574f93023f3c6dd8caf4ae4fe2000000000000000000000000000000000000000000000000a688906bd8b0000000000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000006457b306f33d305bef413d7a9c49674d3630ae5a7be5028122ce123451ab4b43afbe222a000000000000000000000000000000000000000000000000000000006457b7b6037443efe0338d3fcd3ee03e84941b9aec8b5a7355a96a54dd385266c132e7870000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d000000000000000000000000000000000000000000000000000000000000000866726f6d20706f7000000000000000000000000000000000000000000000000000000000000000000000000079f85f6c4c926277ef97370d6f89ab1d78f6a4f800000000000000000000000052047de4458afaaff7c6b954c63033a21efcd2e6000000000000000000000000d3bfa2c17e98274aa86bbea183a5b12562f689c4000000000000000000000000000000000000000000000001236efcbcbb34000000000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000006457b3eef33d305bef413d7a9c49674d3630ae5a7be5028122ce123451ab4b43afbe222a000000000000000000000000000000000000000000000000000000006457b8bfc82f578db121fa3b2a7b872aac2eba4567d2a3d6370b2512ffa36553f82a47f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000009626c65737320796f750000000000000000000000000000000000000000000000000000000000000000000000e711155a0ba0bb66c7154eac8d2891e4bd40728c00000000000000000000000052047de4458afaaff7c6b954c63033a21efcd2e600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000098c445ad57800000000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000006457b7d4099a3ce1c6946df2725ab42f1f31c1ffb2660368f1d18a39a5b31550b331403b000000000000000000000000000000000000000000000000000000006457bc8485e35780222f7202d9d71424f04c2c82a2ec6a26765b6ccc9e45855d7c352dd00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f00000000000000000000000000000000000000000000000000000000000000157468616e6b7320666f72206265696e67206b696e6400000000000000000000000000000000000000000000006932e520e5cc316ccc751ae9dfde8baa9078e1e100000000000000000000000052047de4458afaaff7c6b954c63033a21efcd2e60000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004c072fc631800000000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000006457b9c0f33d305bef413d7a9c49674d3630ae5a7be5028122ce123451ab4b43afbe222a000000000000000000000000000000000000000000000000000000006457be70757156791e37095367580dce430954d79b036359bf8d4d54bd9f01df132f338c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000e476f6420626c65737320796f7521000000000000000000000000000000000000000000000000000000000000289c64c25d4e48176e7f1afe906e9660e8b2c10800000000000000000000000052047de4458afaaff7c6b954c63033a21efcd2e600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004cbd15e72600000000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000006457bb5af33d305bef413d7a9c49674d3630ae5a7be5028122ce123451ab4b43afbe222a000000000000000000000000000000000000000000000000000000006457c00a1c70392a96ad6feeaae7f5a9ec48d4299ad3e95689b775cb3b10f57626a2c3710000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001100000000000000000000000000000000000000000000000000000000000000197468616e6b7320666f72206265696e672074686520626573740000000000000000000000000000000000000052047de4458afaaff7c6b954c63033a21efcd2e6000000000000000000000000289c64c25d4e48176e7f1afe906e9660e8b2c108000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000062e8551e8c00000000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000006457bbfa3d9d719393b2ac88c1ed51674196b7f3daec9f2cfb76a4724e4bea90e37d67c3000000000000000000000000000000000000000000000000000000006457c0aa3a5219e5104e0f7d675a0c907cf48cb8e8eddb7031a1265222c2a3bf707894ac00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000000c7468616e6b73206472616b6500000000000000000000000000000000000000000000000000000000000000005f7fbe4bf8987fa77ec6c22fd3f3d558b3b68d4e00000000000000000000000052047de4458afaaff7c6b954c63033a21efcd2e600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004cbd15e72600000000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000006457bd50f33d305bef413d7a9c49674d3630ae5a7be5028122ce123451ab4b43afbe222a000000000000000000000000000000000000000000000000000000006457c2003f4056d79663ceda96017547b70fab67a60b8e90eb94cee1544d62a5e321e9f400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000013000000000000000000000000000000000000000000000000000000000000000a7468616e6b732062726f00000000000000000000000000000000000000000000"

    angel.performUpkeep(perform_data, {"from": acct})


def main():
    perform_upkeep()
